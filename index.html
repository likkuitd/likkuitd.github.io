<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>ğŸŒŸ ì´ë¦„ ê¶í•© ê³„ì‚°ê¸° ğŸ’–</title>
  <link href="https://fonts.googleapis.com/css2?family=Jua&display=swap" rel="stylesheet" />
  <style>
    body {
      font-family: 'Jua', sans-serif;
      background: linear-gradient(135deg, #ffe4e1 0%, #e6e6fa 100%);
      text-align: center;
      padding: 2em;
      font-size: 20px;
    }
    input {
      padding: 10px;
      font-size: 18px;
      margin: 10px;
      border-radius: 8px;
      border: 1px solid #ccc;
    }
    button {
      font-family: 'Jua', sans-serif;
      padding: 10px 20px;
      margin-top: 20px;
      font-size: 24px;
      background-color: #ff69b4;
      color: white;
      border: none;
      border-radius: 10px;
      cursor: pointer;
    }
    .letters-row, .numbers-row {
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      margin: 10px 0;
    }
    .letter-box, .number-box, .pair-box {
      margin: 5px;
      padding: 10px 15px;
      border-radius: 10px;
      font-weight: bold;
    }
    .letter-box {
      background-color: #ffb6c1;
      color: white;
      font-size: 28px;
    }
    .number-box {
      background-color: #ffe4e1;
      color: #b22222;
      font-size: 22px;
    }
    .pair-box {
      background-color: #ff69b4;
      color: white;
      font-size: 20px;
    }
  </style>
</head>
<body>
  <h1>ğŸŒŸ ì´ë¦„ ê¶í•© ê³„ì‚°ê¸° ğŸ’–</h1>
  <input id="name1" placeholder="ë‹¹ì‹ ì˜ ì´ë¦„" />
  <input id="name2" placeholder="ìƒëŒ€ë°©ì˜ ì´ë¦„" />
  <br />
  <button onclick="startCalculation()">ê¶í•© ë³´ê¸° ğŸ’˜</button>

  <div id="step1"></div>
  <div id="step2"></div>
  <div id="step3"></div>
  <div id="result"></div>

  <audio id="tension-sound" src="https://actions.google.com/sounds/v1/cartoon/wood_plank_flicks.ogg"></audio>

  <script>
    const strokesMap = {
      'ã„±':1,'ã„´':1,'ã„·':2,'ã„¹':3,'ã…':3,'ã…‚':3,'ã……':2,'ã…‡':1,'ã…ˆ':2,'ã…Š':3,'ã…‹':2,'ã…Œ':3,'ã…':4,'ã…':3,
      'ã…':2,'ã…‘':3,'ã…“':2,'ã…•':3,'ã…—':2,'ã…›':3,'ã…œ':2,'ã… ':3,'ã…¡':1,'ã…£':1
    };
    const CHO = ['ã„±','ã„²','ã„´','ã„·','ã„¸','ã„¹','ã…','ã…‚','ã…ƒ','ã……','ã…†','ã…‡','ã…ˆ','ã…‰','ã…Š','ã…‹','ã…Œ','ã…','ã…'];
    const JUNG = ['ã…','ã…','ã…‘','ã…’','ã…“','ã…”','ã…•','ã…–','ã…—','ã…˜','ã…™','ã…š','ã…›','ã…œ','ã…','ã…','ã…Ÿ','ã… ','ã…¡','ã…¢','ã…£'];
    const JONG = ['', 'ã„±','ã„²','ã„³','ã„´','ã„µ','ã„¶','ã„·','ã„¹','ã„º','ã„»','ã„¼','ã„½','ã„¾','ã„¿','ã…€','ã…','ã…‚','ã…„','ã……','ã…†','ã…‡','ã…ˆ','ã…Š','ã…‹','ã…Œ','ã…','ã…'];

    function getJungStroke(j) {
      const combo = {
        'ã…˜':['ã…—','ã…'],'ã…™':['ã…—','ã…'],'ã…š':['ã…—','ã…£'],
        'ã…':['ã…œ','ã…“'],'ã…':['ã…œ','ã…”'],'ã…Ÿ':['ã…œ','ã…£'],'ã…¢':['ã…¡','ã…£']
      };
      if (strokesMap[j]) return strokesMap[j];
      if (combo[j]) return combo[j].reduce((a,c)=>a+strokesMap[c],0);
      return 0;
    }

    function getStroke(c){
      const code = c.charCodeAt(0);
      if (code < 0xAC00 || code > 0xD7A3) return 0;
      const base = code - 0xAC00;
      const cho = CHO[Math.floor(base / 588)];
      const jung = JUNG[Math.floor((base % 588) / 28)];
      const jong = JONG[base % 28];
      return (strokesMap[cho]||0)+(getJungStroke(jung)||0)+(strokesMap[jong]||0);
    }

    function startCalculation(){
      const n1 = document.getElementById('name1').value.trim();
      const n2 = document.getElementById('name2').value.trim();
      if(!n1 || !n2){ alert('ì´ë¦„ì„ ëª¨ë‘ ì…ë ¥í•˜ì„¸ìš”!'); return; }

      let mixed = '';
      for(let i=0; i<Math.max(n1.length,n2.length); i++){
        if(n1[i]) mixed += n1[i];
        if(n2[i]) mixed += n2[i];
      }

      const strokes = mixed.split('').map(getStroke);

      document.getElementById('step1').innerHTML =
        '<div class="letters-row">' +
        mixed.split('').map(c => `<div class="letter-box">${c}</div>`).join('') +
        '</div>' +
        '<div class="numbers-row">' +
        strokes.map(n => `<div class="number-box">${n}</div>`).join('') +
        '</div>';

      const pairs = [];
      for (let i = 0; i < strokes.length - 1; i += 2) {
        pairs.push(strokes[i] + strokes[i + 1]);
      }
      window._pairs = pairs;
      document.getElementById('step2').innerHTML =
        '<button onclick="showThreeNumbers()">ë‹¤ìŒ ë‹¨ê³„ë¡œ â†’</button>';

      // ì´ˆê¸°í™”
      document.getElementById('step3').innerHTML = '';
      document.getElementById('result').innerHTML = '';
    }

    function showThreeNumbers() {
      const pairs = window._pairs;
      document.getElementById('step2').innerHTML =
        '<div class="numbers-row">' +
        pairs.map(p => `<div class="pair-box">${p}</div>`).join('') +
        '</div>' +
        '<button onclick="goToStep3()">ê²°ê³¼ ë³´ê¸° ğŸ‰</button>';
    }

    function goToStep3() {
      const [a, b, c] = window._pairs;
      const result1 = (a + b) % 10;
      const result2 = c % 10;
      const percent = parseInt(`${result1}${result2}`);

      document.getElementById('tension-sound').play();

      let msg = '';
      if (percent >= 90) msg = 'ì²œìƒì—°ë¶„! ìš´ëª… ê·¸ ìì²´ ğŸ’';
      else if (percent >= 75) msg = 'ê¶í•©ì´ ê½¤ ì¢‹ì•„ìš”! ğŸ’‘';
      else if (percent >= 50) msg = 'ì¡°ê¸ˆ ë…¸ë ¥í•˜ë©´ ë©‹ì§„ ì¸ì—°ì´ ë  ìˆ˜ ìˆì–´ìš”! ğŸŒˆ';
      else if (percent >= 30) msg = 'ì„±ê²© ì°¨ì´ë¥¼ ì´í•´í•´ë³´ë ¤ëŠ” ë…¸ë ¥ì´ í•„ìš”í• ì§€ë„...? ğŸ¤”';
      else msg = 'ê·¸ëƒ¥ ì¹œêµ¬ë¡œ ì§€ë‚´ëŠ” ê²Œ ì¢‹ì„ì§€ë„ ëª°ë¼ìš”... ğŸ˜…';

      document.getElementById('step3').innerHTML = '';
      document.getElementById('result').innerHTML =
        `<h2>â¤ï¸ ê¶í•© í¼ì„¼íŠ¸: ${percent}% â¤ï¸</h2><p>${msg}</p><br><button onclick="location.reload()">ë‹¤ë¥¸ ì‚¬ëŒì€ ì–´ë–¨ê¹Œ? ğŸ”</button>`;
      document.getElementById('step2').style.display = 'none';
    }
  </script>
</body>
</html>